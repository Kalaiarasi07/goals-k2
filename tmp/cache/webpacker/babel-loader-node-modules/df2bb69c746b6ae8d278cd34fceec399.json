{"ast":null,"code":"var _jsxFileName = \"/home/user/MP/rrapp/app/javascript/components/UsersList.jsx\";\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nimport React from 'react';\nimport { useState, useEffect } from 'react';\nimport Axios from 'axios';\nimport { useHistory } from \"react-router-dom\";\nimport { get_date_string, logout } from './shared/functions';\nimport DatePicker from \"react-datepicker\";\nimport \"react-datepicker/dist/react-datepicker.css\"; // API call to list all users only if logged in\n\nexport default function UsersList() {\n  var _this = this;\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      users = _useState2[0],\n      setUsers = _useState2[1];\n\n  var _useState3 = useState(),\n      _useState4 = _slicedToArray(_useState3, 2),\n      startDate = _useState4[0],\n      setStartDate = _useState4[1];\n\n  var _useState5 = useState(),\n      _useState6 = _slicedToArray(_useState5, 2),\n      endDate = _useState6[0],\n      setEndDate = _useState6[1];\n\n  var history = useHistory();\n  useEffect(function () {\n    showAllUsers();\n  }, []);\n\n  var showAllUsers = function showAllUsers() {\n    Axios.post('/api/users').then(function (resp) {\n      setUsers(resp.data.users);\n      console.log(resp);\n    })[\"catch\"](function (error) {\n      alert(error.response.data.error);\n      history.push('/login'); // history.go(0)\n    });\n  };\n\n  var setDateRange = function setDateRange(dates) {\n    setStartDate(dates[0]);\n    setEndDate(dates[1]);\n  };\n\n  var sortByDate = function sortByDate() {\n    console.log(startDate);\n    console.log(endDate);\n    var startDateString = get_date_string(startDate);\n    var endDateString = get_date_string(endDate);\n    console.log(startDateString + \" \" + endDateString);\n    Axios.post('/api/users/sort', {\n      start: startDateString,\n      end: endDateString\n    }).then(function (resp) {\n      setUsers(resp.data.users);\n      console.log(resp);\n    })[\"catch\"](function (error) {\n      console.log(error);\n    });\n  };\n\n  var users_list = users.map(function (item) {\n    return /*#__PURE__*/React.createElement(\"tr\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      key: item.name,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 9\n      }\n    }, \"|\", item.name), /*#__PURE__*/React.createElement(\"td\", {\n      key: item.email,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 9\n      }\n    }, \"|\", item.email), /*#__PURE__*/React.createElement(\"td\", {\n      key: item.phone,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 9\n      }\n    }, \"|\", item.phone), /*#__PURE__*/React.createElement(\"td\", {\n      key: item.user_type,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 9\n      }\n    }, \"|\", item.user_type), /*#__PURE__*/React.createElement(\"td\", {\n      key: item.joined_at,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 9\n      }\n    }, \"|\", new Date(item.joined_at * 1000).toLocaleDateString()));\n  });\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 7\n    }\n  }, \"Users list page\"), /*#__PURE__*/React.createElement(DatePicker, {\n    selectsRange: true,\n    startDate: startDate,\n    endDate: endDate,\n    onChange: setDateRange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    name: \"sort\",\n    onClick: sortByDate,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 7\n    }\n  }, \"Sort\"), /*#__PURE__*/React.createElement(\"button\", {\n    name: \"showall\",\n    onClick: showAllUsers,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }\n  }, \"Show All\"), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"table\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"tbody\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 9\n    }\n  }, users_list)), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    onClick: logout,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 7\n    }\n  }, \"Log out\"));\n}","map":{"version":3,"names":["React","useState","useEffect","Axios","useHistory","get_date_string","logout","DatePicker","UsersList","users","setUsers","startDate","setStartDate","endDate","setEndDate","history","showAllUsers","post","then","resp","data","console","log","error","alert","response","push","setDateRange","dates","sortByDate","startDateString","endDateString","start","end","users_list","map","item","name","email","phone","user_type","joined_at","Date","toLocaleDateString"],"sources":["/home/user/MP/rrapp/app/javascript/components/UsersList.jsx"],"sourcesContent":["import React from 'react';\nimport { useState, useEffect } from 'react';\nimport Axios from 'axios';\nimport { useHistory } from \"react-router-dom\";\nimport { get_date_string, logout } from './shared/functions';\nimport DatePicker from \"react-datepicker\";\nimport \"react-datepicker/dist/react-datepicker.css\";\n\n// API call to list all users only if logged in\nexport default function UsersList() {\n  const [users, setUsers] = useState([]);\n  const [startDate, setStartDate] = useState();\n  const [endDate, setEndDate] = useState();\n  const history = useHistory();\n  useEffect(() => {\n    showAllUsers()\n  }, [])\n\n  const showAllUsers = () => {\n    \n    Axios.post('/api/users')\n      .then(resp => {\n        setUsers(resp.data.users)\n        console.log(resp)\n      })\n      .catch(error => {\n        alert(error.response.data.error)\n        history.push('/login')\n        // history.go(0)\n      })\n  }\n\n  const setDateRange = (dates) => {\n    setStartDate(dates[0]);\n    setEndDate(dates[1]);\n  }\n\n  const sortByDate = () => {\n    console.log(startDate)\n    console.log(endDate)\n\n    let startDateString = get_date_string(startDate)\n    let endDateString = get_date_string(endDate)\n\n    console.log(startDateString + \" \" + endDateString)\n\n    Axios.post('/api/users/sort', { start: startDateString, end: endDateString })\n      .then(function (resp) {\n        setUsers(resp.data.users)\n        console.log(resp)\n      })\n      .catch(function (error) {\n        console.log(error);\n      })\n  }\n\n  const users_list = users.map(item => {\n    return (\n      <tr>\n        <td key={item.name}>|{item.name}</td>\n        <td key={item.email}>|{item.email}</td>\n        <td key={item.phone}>|{item.phone}</td>\n        <td key={item.user_type}>|{item.user_type}</td>\n        <td key={item.joined_at}>|{new Date(item.joined_at * 1000).toLocaleDateString()}</td>\n      </tr>\n    )\n  })\n\n  return (\n    <>\n      <h1>Users list page</h1>\n      <DatePicker\n        selectsRange={true}\n        startDate={startDate}\n        endDate={endDate}\n        onChange={setDateRange}\n      />\n      <br /><br />\n      <button name=\"sort\" onClick={sortByDate} >Sort</button>\n      <button name=\"showall\" onClick={showAllUsers}>Show All</button>\n      <br /><br />\n      <table>\n        <tbody>{users_list}</tbody>\n      </table>\n      <br /><br />\n      <div onClick={logout} >Log out</div>\n    </>\n  )\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}